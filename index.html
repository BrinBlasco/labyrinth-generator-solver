<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Labyrinth</title>
    <link rel="stylesheet" href="style.css">
    <link rel="shortcut icon" href="./assets/maze_favicon.png" type="image/x-icon">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
</head>
<body>
    <h1 style="padding: 2rem; font-size: 3rem;">
        Maze Generator and Solver
    </h1>
    <div class="main">

        <div class="left"> 
            <div class="maze"></div>
        </div>

        <div class="right">

            <div class="back-arrow">
                <i class="fa fa-chevron-right" aria-hidden="true"></i>
            </div>

            <div class="maze-parameters">
                
                <h3 style="text-align: center;">Settings</h3>

                <div class="setting">
                    <label id="numrows">Number of Rows</label>
                    <input type="range" min="5" max="30" name="" value="5" id="numrows">
                    <p id="numrowsDisp">Default (10)</p>
                </div>

                <div class="setting">
                    <label for="numcols">Number of Rows</label>
                    <input type="range" min="5" max="30" name="" value="5" id="numcols">
                    <p id="numcolsDisp">Default (10)</p>
                </div>

                <div class="setting">
                    <label for="cellsize">Cell Size</label>
                    <input type="range" min="5" max="50" name="" step="5" value="5" id="cellsize">
                    <p id="cellsizeDisp">Default (50)</p>
                </div>

                <div class="setting">
                    <label for="framerate">Framerate</label>
                    <input type="range" name="" min="0" max="60" step="5" value="0" id="framerate">
                    <p id="framerateDisp">Default (0)</p>
                </div>

                <div class="btns">
                    <button id="generate">Generate</button>
                </div>
            </div>

            <div class="solving-algorithms hidden">
                
                <h3 style="text-align: center;">Solving <br> Algorithm</h3>

                <div class="setting">
                    <label for="dfs">DFS</label>
                    <input type="radio" name="alg" id="dfs" value="dfs">
                </div>
                <div class="setting">
                    <label for="bfs">BFS</label>
                    <input type="radio" name="alg" id="bfs" value="bfs">
                </div>
                <div class="setting">
                    <label for="dijkstra">Dijkstra's</label>
                    <input type="radio" name="alg" id="dijkstra" value="dijkstra">
                </div>
                <div class="setting">
                    <label for="astar">A-Star</label>
                        
                    <input type="radio" name="alg" id="astar" value="astar">
                </div>

                <div class="btns">
                    <button id="solve">Solve</button>
                </div>
            </div>

        </div> 
    </div>
    <script src="Utils.js"></script>
    <script src="Drawing.js"></script>
    <script src="Cell.js"></script>
    <script src="Maze.js"></script>
    <script>

        let rowsField = document.querySelector("#numrowsDisp");
        let colsField = document.querySelector("#numcolsDisp");
        let cellField = document.querySelector("#cellsizeDisp");
        let frameField = document.querySelector("#framerateDisp");

        let dispFields = [rowsField, colsField, cellField, frameField];

        let defaultValues = {
            rows : 10,
            cols : 10,
            cellsize : 50,
            fps: 0
        };

        const algs = Object.freeze({
            DFS : "dfs"
        })

        const arrow = document.querySelector(".right .back-arrow");
        const mazeParameters = document.querySelector(".right .maze-parameters");
        const solvingAlgorithms = document.querySelector(".right .solving-algorithms");

        arrow.addEventListener("click", (e) => {
            solvingAlgorithms.classList.toggle("hidden");
            mazeParameters.classList.toggle("hidden");
            arrow.classList.toggle("rotate");
        });
        arrow.style.display = "none";

        
        document.querySelectorAll('input[type="range"]').forEach((el, i) => {
            el.addEventListener("input", (e) => {
                dispFields[i].textContent = e.target.value;
                //defaultValues[i] = parseInt(e.target.value);
                defaultValues[Object.keys(defaultValues)[i]] = parseInt(e.target.value);
            });
        });

        document.querySelector("#generate").addEventListener("click", async (e) => {

            let generateButton = document.querySelector("#generate");
            let solveButton = document.querySelector("#solve");

            generateButton.disabled = true;
            let maze = new Maze(...Object.values(defaultValues));
            maze.generateMaze(0); // pogrunti za starting position kku nastimat
            generateButton.disabled = false;

            solveButton.addEventListener("click", () => {
                let alg = document.querySelector("input[name='alg']:checked").value;
                solveButton.disabled = true;

                switch (alg) {
                    case "dfs":
                        maze.solveMazeDfs();
                        break;
                    case "bfs":
                        maze.solveMazeBfs();
                        break;
                    case "dijkstra":
                        maze.solveMazeDijkstra();
                        break; 
                    case "astar":
                        maze.solveMazeAstar();
                        break;
                    default:
                        console.log("Unlockey u hit default");
                        break;
                }

                solveButton.disabled = false;
                
            });

            // let maze = document.querySelector(".maze");
            // let cellR;
            // let cellY;

            // maze.addEventListener("click", function (e) {
            //     let bounds = e.target.getBoundingClientRect();

            //     let x = e.clientX - bounds.left;
            //     let y = e.clientY - bounds.top;

            //     cellR = x;
            //     cellC = y;
            //     console.log(x, y);
                
            //     let row = Math.ceil(y / 50) - 1;
            //     let column = Math.ceil(x / 50) - 1;

            //     let index = column + row * 10;
            //     console.log(index, row, column);
            // });

        });

            
    </script>
</body>
</html>